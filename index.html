<!doctype html>
<html lang="ja">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Only One Fund - å¿œæ´ã§ç¹‹ãŒã‚‹æŒ‘æˆ¦ã®SNS</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      width: 100%;
      height: 100%;
      overflow-x: hidden;
    }

    html, body, #app {
      height: 100%;
    }

    #app {
      width: 100%;
      height: 100%;
      overflow-y: auto;
      overflow-x: hidden;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
      min-height: 100%;
      background: white;
      box-shadow: 0 0 40px rgba(0,0,0,0.1);
    }

    /* Welcome Screen */
    .welcome-screen {
      padding: 60px 24px;
      text-align: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      min-height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .welcome-icon {
      font-size: 80px;
      margin-bottom: 24px;
    }

    .welcome-title {
      font-size: 32px;
      font-weight: bold;
      margin-bottom: 16px;
    }

    .welcome-subtitle {
      font-size: 18px;
      margin-bottom: 40px;
      opacity: 0.9;
    }

    .welcome-concept {
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 32px 24px;
      margin-bottom: 32px;
      text-align: left;
    }

    .welcome-concept h3 {
      font-size: 20px;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .welcome-concept p {
      font-size: 16px;
      line-height: 1.8;
      opacity: 0.95;
      margin-bottom: 12px;
    }

    .welcome-rules {
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 32px;
      text-align: left;
    }

    .welcome-rules h4 {
      font-size: 16px;
      margin-bottom: 12px;
      opacity: 0.9;
    }

    .welcome-rules ul {
      list-style: none;
    }

    .welcome-rules li {
      font-size: 14px;
      padding: 8px 0;
      padding-left: 24px;
      position: relative;
      opacity: 0.9;
    }

    .welcome-rules li:before {
      content: "âœ“";
      position: absolute;
      left: 0;
      font-weight: bold;
    }

    .btn-start {
      background: white;
      color: #667eea;
      border: none;
      padding: 16px 48px;
      border-radius: 50px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
    }

    .btn-start:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.25);
    }

    /* Icon Selection */
    .icon-selection {
      margin-bottom: 24px;
    }

    .icon-selection-label {
      display: block;
      font-size: 14px;
      margin-bottom: 12px;
      opacity: 0.95;
    }

    .icon-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 12px;
      max-width: 400px;
      margin: 0 auto;
    }

    .icon-option {
      width: 100%;
      aspect-ratio: 1;
      border: 3px solid rgba(255,255,255,0.3);
      border-radius: 16px;
      background: rgba(255,255,255,0.2);
      font-size: 32px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .icon-option:hover {
      background: rgba(255,255,255,0.3);
      border-color: rgba(255,255,255,0.6);
      transform: scale(1.1);
    }

    .icon-option.selected {
      background: white;
      border-color: white;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      transform: scale(1.15);
    }

    /* Header */
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 16px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-title {
      font-size: 20px;
      font-weight: bold;
    }

    .header-points {
      background: rgba(255,255,255,0.2);
      backdrop-filter: blur(10px);
      padding: 8px 16px;
      border-radius: 50px;
      font-size: 14px;
      font-weight: bold;
    }

    .points-number {
      font-size: 20px;
      margin-left: 4px;
    }

    /* Navigation */
    .nav-tabs {
      display: flex;
      background: #f8f9fa;
      border-bottom: 2px solid #e9ecef;
      position: sticky;
      top: 60px;
      z-index: 99;
    }

    .nav-tab {
      flex: 1;
      padding: 16px;
      text-align: center;
      background: none;
      border: none;
      font-size: 14px;
      font-weight: 600;
      color: #6c757d;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }

    .nav-tab.active {
      color: #667eea;
      background: white;
    }

    .nav-tab.active:after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      right: 0;
      height: 2px;
      background: #667eea;
    }

    /* Feed */
    .feed {
      padding: 20px;
    }

    .category-filter {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      overflow-x: auto;
      padding-bottom: 8px;
    }

    .filter-btn {
      padding: 8px 16px;
      border-radius: 50px;
      border: 2px solid #e9ecef;
      background: white;
      font-size: 13px;
      font-weight: 600;
      color: #495057;
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.3s ease;
    }

    .filter-btn.active {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    .fund-card {
      background: white;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      transition: all 0.3s ease;
      border: 2px solid #f8f9fa;
    }

    .fund-card:hover {
      box-shadow: 0 4px 16px rgba(0,0,0,0.12);
      border-color: #667eea;
    }

    .fund-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 12px;
    }

    .fund-title {
      font-size: 18px;
      font-weight: bold;
      color: #212529;
      margin-bottom: 8px;
    }

    .category-badge {
      padding: 4px 12px;
      border-radius: 50px;
      font-size: 12px;
      font-weight: 600;
      white-space: nowrap;
    }

    .category-challenge { background: #fff3cd; color: #856404; }
    .category-creation { background: #d1ecf1; color: #0c5460; }
    .category-learning { background: #d4edda; color: #155724; }
    .category-social { background: #f8d7da; color: #721c24; }

    .fund-creator {
      font-size: 13px;
      color: #6c757d;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .fund-creator-icon {
      font-size: 16px;
    }

    .fund-description {
      font-size: 14px;
      line-height: 1.6;
      color: #495057;
      margin-bottom: 16px;
    }

    .progress-section {
      margin-bottom: 16px;
    }

    .progress-label {
      display: flex;
      justify-content: space-between;
      font-size: 13px;
      color: #6c757d;
      margin-bottom: 8px;
    }

    .progress-bar-bg {
      background: #e9ecef;
      height: 8px;
      border-radius: 50px;
      overflow: hidden;
    }

    .progress-bar-fill {
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      height: 100%;
      border-radius: 50px;
      transition: width 0.5s ease;
    }

    .supporters-section {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 16px;
    }

    .supporter-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: bold;
      border: 2px solid white;
      margin-left: -8px;
    }

    .supporter-avatar:first-child {
      margin-left: 0;
    }

    .supporter-count {
      font-size: 13px;
      color: #6c757d;
      margin-left: 4px;
    }

    .fund-actions {
      display: flex;
      gap: 8px;
    }

    .btn-support {
      flex: 1;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 50px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    .btn-support:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .btn-support:disabled {
      background: #e9ecef;
      color: #adb5bd;
      cursor: not-allowed;
    }

    .btn-view {
      padding: 12px 24px;
      border-radius: 50px;
      border: 2px solid #667eea;
      background: white;
      color: #667eea;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-view:hover {
      background: #667eea;
      color: white;
    }

    /* Profile */
    .profile {
      padding: 20px;
    }

    .profile-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 16px;
      padding: 32px 24px;
      color: white;
      text-align: center;
      margin-bottom: 24px;
    }

    .profile-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: rgba(255,255,255,0.3);
      margin: 0 auto 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
      border: 4px solid white;
    }

    .profile-name {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 8px;
    }

    .profile-badge {
      display: inline-block;
      padding: 6px 16px;
      border-radius: 50px;
      background: rgba(255,255,255,0.2);
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 16px;
    }

    .profile-stats {
      display: flex;
      justify-content: space-around;
      margin-top: 20px;
    }

    .stat-item {
      text-align: center;
    }

    .stat-value {
      font-size: 28px;
      font-weight: bold;
      display: block;
    }

    .stat-label {
      font-size: 12px;
      opacity: 0.9;
      margin-top: 4px;
    }

    .section-title {
      font-size: 18px;
      font-weight: bold;
      color: #212529;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn-create-fund {
      width: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 16px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      margin-bottom: 24px;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn-create-fund:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .btn-create-fund:disabled {
      background: #e9ecef;
      color: #adb5bd;
      cursor: not-allowed;
    }

    .create-fund-requirement {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 12px;
      border-radius: 8px;
      font-size: 13px;
      color: #856404;
      margin-bottom: 24px;
    }

    /* Premium Card */
    .premium-card {
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 24px;
      color: #333;
      box-shadow: 0 4px 16px rgba(255, 215, 0, 0.4);
      border: 2px solid #ffc107;
    }

    .premium-title {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .premium-benefits {
      background: rgba(255,255,255,0.5);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
    }

    .premium-benefit-item {
      font-size: 14px;
      padding: 8px 0;
      padding-left: 24px;
      position: relative;
      line-height: 1.6;
    }

    .premium-benefit-item:before {
      content: "âœ“";
      position: absolute;
      left: 0;
      font-weight: bold;
      color: #28a745;
    }

    .premium-price {
      text-align: center;
      margin-bottom: 16px;
    }

    .price-amount {
      font-size: 32px;
      font-weight: bold;
      color: #333;
    }

    .price-period {
      font-size: 14px;
      color: #666;
    }

    .btn-premium {
      width: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 16px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn-premium:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
    }

    .demo-badge {
      display: inline-block;
      background: rgba(255,255,255,0.8);
      color: #666;
      padding: 4px 12px;
      border-radius: 50px;
      font-size: 12px;
      font-weight: 600;
      margin-left: 8px;
    }

    /* Earn Points Section */
    .earn-points-card {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 24px;
      color: white;
      box-shadow: 0 4px 16px rgba(40, 167, 69, 0.3);
    }

    .earn-points-title {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .earn-points-description {
      font-size: 14px;
      line-height: 1.6;
      opacity: 0.95;
      margin-bottom: 16px;
    }

    .btn-watch-ad {
      width: 100%;
      background: white;
      color: #28a745;
      border: none;
      padding: 14px;
      border-radius: 12px;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn-watch-ad:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 255, 255, 0.5);
    }

    .btn-watch-ad:disabled {
      background: rgba(255, 255, 255, 0.3);
      color: rgba(255, 255, 255, 0.7);
      cursor: not-allowed;
    }

    /* Ad Modal */
    .ad-modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .ad-modal {
      background: white;
      border-radius: 16px;
      padding: 32px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      animation: slideUp 0.3s ease;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .ad-icon {
      font-size: 64px;
      margin-bottom: 16px;
    }

    .ad-title {
      font-size: 22px;
      font-weight: bold;
      color: #212529;
      margin-bottom: 12px;
    }

    .ad-message {
      font-size: 15px;
      color: #6c757d;
      line-height: 1.6;
      margin-bottom: 24px;
    }

    .ad-timer {
      font-size: 48px;
      font-weight: bold;
      color: #667eea;
      margin-bottom: 16px;
    }

    .ad-progress {
      background: #e9ecef;
      height: 8px;
      border-radius: 50px;
      overflow: hidden;
      margin-bottom: 24px;
    }

    .ad-progress-fill {
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      height: 100%;
      border-radius: 50px;
      transition: width 0.3s ease;
    }

    .btn-close-ad {
      width: 100%;
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      border: none;
      padding: 14px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-close-ad:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
    }

    /* Create Fund Form */
    .create-fund-form {
      padding: 20px;
    }

    .form-group {
      margin-bottom: 24px;
    }

    .form-label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: #495057;
      margin-bottom: 8px;
    }

    .form-input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      font-size: 14px;
      transition: all 0.3s ease;
      font-family: inherit;
    }

    .form-input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .welcome-input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 8px;
      font-size: 16px;
      background: rgba(255,255,255,0.2);
      color: white;
      font-family: inherit;
      transition: all 0.3s ease;
    }

    .welcome-input::placeholder {
      color: rgba(255,255,255,0.7);
    }

    .welcome-input:focus {
      outline: none;
      border-color: rgba(255,255,255,0.6);
      background: rgba(255,255,255,0.25);
      box-shadow: 0 0 0 3px rgba(255,255,255,0.1);
    }

    .form-textarea {
      min-height: 120px;
      resize: vertical;
    }

    .char-count {
      font-size: 12px;
      color: #6c757d;
      text-align: right;
      margin-top: 4px;
    }

    .category-select {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .category-option {
      padding: 16px;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      background: white;
    }

    .category-option:hover {
      border-color: #667eea;
      background: #f8f9ff;
    }

    .category-option.selected {
      border-color: #667eea;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .category-option-icon {
      font-size: 28px;
      margin-bottom: 8px;
    }

    .category-option-label {
      font-size: 14px;
      font-weight: 600;
    }

    .warning-box {
      background: #f8d7da;
      border-left: 4px solid #dc3545;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 24px;
    }

    .warning-title {
      font-size: 14px;
      font-weight: bold;
      color: #721c24;
      margin-bottom: 8px;
    }

    .warning-text {
      font-size: 13px;
      color: #721c24;
      line-height: 1.6;
    }

    .btn-submit {
      width: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 16px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-submit:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .btn-submit:disabled {
      background: #e9ecef;
      color: #adb5bd;
      cursor: not-allowed;
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #6c757d;
    }

    .empty-icon {
      font-size: 64px;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .empty-text {
      font-size: 16px;
    }

    /* Toast Notification */
    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #212529;
      color: white;
      padding: 16px 24px;
      border-radius: 50px;
      font-size: 14px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      z-index: 1000;
      animation: slideUpToast 0.3s ease;
    }

    @keyframes slideUpToast {
      from {
        opacity: 0;
        transform: translate(-50%, 20px);
      }
      to {
        opacity: 1;
        transform: translate(-50%, 0);
      }
    }

    .toast.success {
      background: #28a745;
    }

    .toast.error {
      background: #dc3545;
    }

    /* Responsive */
    @media (max-width: 600px) {
      .welcome-title {
        font-size: 24px;
      }
      
      .welcome-subtitle {
        font-size: 16px;
      }

      .category-select {
        grid-template-columns: 1fr;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div id="app">
   <div class="container">
    <div class="welcome-screen">
     <div class="welcome-icon">
      ğŸ¯
     </div>
     <h1 class="welcome-title">æº–å‚™ä¸­...</h1>
    </div>
   </div>
  </div>
  <script>
    // Default Configuration
    const defaultConfig = {
      app_title: "Only One Fund",
      welcome_title: "Only One Fundã¸ã‚ˆã†ã“ã",
      points_explanation: "ã‚ãªãŸã«ã¯10ãƒã‚¤ãƒ³ãƒˆãŒä¸ãˆã‚‰ã‚Œã¾ã™"
    };

    // Initialize Element SDK
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig: defaultConfig,
        onConfigChange: async (config) => {
          // Config changes don't require UI updates for this app
        },
        mapToCapabilities: (config) => ({
          recolorables: [],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (config) => new Map([
          ["app_title", config.app_title || defaultConfig.app_title],
          ["welcome_title", config.welcome_title || defaultConfig.welcome_title],
          ["points_explanation", config.points_explanation || defaultConfig.points_explanation]
        ])
      });
    }

    // Available icons for users to choose from
    const AVAILABLE_ICONS = ['ğŸ‘¤', 'ğŸ¶', 'ğŸ±', 'ğŸ¼', 'ğŸ¦Š', 'ğŸ»', 'ğŸ°', 'ğŸ¦', 'ğŸ¸', 'ğŸµ', 'ğŸ¦‰', 'ğŸ§', 'ğŸ¦„', 'ğŸŒŸ', 'ğŸ’'];

    // Sample funds data (expanded with 10 more)
    const SAMPLE_FUNDS = [
      {
        id: 'fund1',
        creatorId: 'user_sample1',
        creatorName: 'ç”°ä¸­å¤ªéƒ',
        creatorIcon: 'ğŸ¶',
        title: 'Webã‚¢ãƒ—ãƒªé–‹ç™ºã‚¹ã‚­ãƒ«ã‚’ç¿’å¾—ã™ã‚‹',
        category: 'learning',
        description: 'Reactã€Node.jsã‚’ä½¿ã£ãŸå®Ÿè·µçš„ãªWebã‚¢ãƒ—ãƒªé–‹ç™ºã‚’3ãƒ¶æœˆã§ç¿’å¾—ã—ã€ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚’ä½œæˆã—ã¾ã™ã€‚',
        targetPoints: 25,
        currentPoints: 18,
        supporters: ['user_sample2', 'user_sample3', 'user_sample4']
      },
      {
        id: 'fund2',
        creatorId: 'user_sample2',
        creatorName: 'ä½è—¤èŠ±å­',
        creatorIcon: 'ğŸ±',
        title: 'ã‚ªãƒªã‚¸ãƒŠãƒ«çµµæœ¬ã‚’åˆ¶ä½œãƒ»å‡ºç‰ˆã™ã‚‹',
        category: 'creation',
        description: 'å­ä¾›ãŸã¡ã«å¤¢ã‚’ä¸ãˆã‚‹çµµæœ¬ã‚’åˆ¶ä½œã—ã€é›»å­æ›¸ç±ã¨ã—ã¦å‡ºç‰ˆã—ã¾ã™ã€‚ã‚¤ãƒ©ã‚¹ãƒˆã¨ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å…¨ã¦åˆ¶ä½œã—ã¾ã™ã€‚',
        targetPoints: 30,
        currentPoints: 22,
        supporters: ['user_sample1', 'user_sample3', 'user_sample5']
      },
      {
        id: 'fund3',
        creatorId: 'user_sample3',
        creatorName: 'éˆ´æœ¨ä¸€éƒ',
        creatorIcon: 'ğŸ¼',
        title: 'ãƒãƒ©ã‚½ãƒ³å®Œèµ°ã«æŒ‘æˆ¦',
        category: 'challenge',
        description: 'åˆã‚ã¦ã®ãƒ•ãƒ«ãƒãƒ©ã‚½ãƒ³å®Œèµ°ã‚’ç›®æŒ‡ã—ã¦6ãƒ¶æœˆé–“ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã—ã¾ã™ã€‚å¥åº·çš„ãªãƒ©ã‚¤ãƒ•ã‚¹ã‚¿ã‚¤ãƒ«ã®ç¢ºç«‹ãŒç›®æ¨™ã§ã™ã€‚',
        targetPoints: 20,
        currentPoints: 15,
        supporters: ['user_sample2', 'user_sample4']
      },
      {
        id: 'fund4',
        creatorId: 'user_sample4',
        creatorName: 'å±±ç”°ç¾å’²',
        creatorIcon: 'ğŸ¦Š',
        title: 'åœ°åŸŸã®æ¸…æƒãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢æ´»å‹•ã‚’çµ„ç¹”åŒ–',
        category: 'social',
        description: 'æœˆ1å›ã®åœ°åŸŸæ¸…æƒæ´»å‹•ã‚’ç¶™ç¶šçš„ã«å®Ÿæ–½ã—ã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®ç¾åŒ–ã¨ä½æ°‘ã®çµ†ã‚’æ·±ã‚ã¾ã™ã€‚',
        targetPoints: 15,
        currentPoints: 12,
        supporters: ['user_sample1', 'user_sample5']
      },
      {
        id: 'fund5',
        creatorId: 'user_sample5',
        creatorName: 'é«˜æ©‹å¥å¤ª',
        creatorIcon: 'ğŸ»',
        title: 'ãƒ”ã‚¢ãƒæ¼”å¥æŠ€è¡“ã®å‘ä¸Šã¨ã‚ªãƒ³ãƒ©ã‚¤ãƒ³é…ä¿¡',
        category: 'creation',
        description: 'ã‚¯ãƒ©ã‚·ãƒƒã‚¯ãƒ”ã‚¢ãƒã®æŠ€è¡“ã‚’ç£¨ãã€æœˆ2å›ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æ¼”å¥ä¼šã‚’é–‹å‚¬ã—ã¦éŸ³æ¥½ã‚’å±Šã‘ã¾ã™ã€‚',
        targetPoints: 25,
        currentPoints: 8,
        supporters: ['user_sample3']
      },
      {
        id: 'fund6',
        creatorId: 'user_sample6',
        creatorName: 'ä¼Šè—¤éº»è¡£',
        creatorIcon: 'ğŸ°',
        title: 'ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ã®åŸºç¤ã‚’å­¦ã¶',
        category: 'learning',
        description: 'Pythonã€çµ±è¨ˆå­¦ã€æ©Ÿæ¢°å­¦ç¿’ã®åŸºç¤ã‚’ç¿’å¾—ã—ã€ãƒ‡ãƒ¼ã‚¿åˆ†æã®ã‚¹ã‚­ãƒ«ã‚’èº«ã«ã¤ã‘ã¾ã™ã€‚',
        targetPoints: 30,
        currentPoints: 25,
        supporters: ['user_sample1', 'user_sample2', 'user_sample7']
      },
      {
        id: 'fund7',
        creatorId: 'user_sample7',
        creatorName: 'æ¸¡è¾ºå„ªä»‹',
        creatorIcon: 'ğŸ¦',
        title: 'ç‹¬è‡ªã®ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã‚’ãƒªãƒªãƒ¼ã‚¹',
        category: 'challenge',
        description: 'ç”Ÿæ´»ã‚’ä¾¿åˆ©ã«ã™ã‚‹ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã‚’é–‹ç™ºã—ã€App Storeã¨Google Playã§ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã™ã€‚',
        targetPoints: 40,
        currentPoints: 30,
        supporters: ['user_sample2', 'user_sample3', 'user_sample4', 'user_sample5']
      },
      {
        id: 'fund8',
        creatorId: 'user_sample8',
        creatorName: 'ä¸­æ‘ã•ãã‚‰',
        creatorIcon: 'ğŸ¸',
        title: 'åœ°åŸŸã®å­ä¾›ãŸã¡ã«ç„¡æ–™ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°æ•™å®¤',
        category: 'social',
        description: 'æœˆ2å›ã€åœ°åŸŸã®å­ä¾›ãŸã¡ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®æ¥½ã—ã•ã‚’æ•™ãˆã‚‹ç„¡æ–™æ•™å®¤ã‚’é–‹å‚¬ã—ã¾ã™ã€‚',
        targetPoints: 20,
        currentPoints: 14,
        supporters: ['user_sample1', 'user_sample6', 'user_sample7']
      },
      {
        id: 'fund9',
        creatorId: 'user_sample9',
        creatorName: 'å°æ—å¤§è¼”',
        creatorIcon: 'ğŸµ',
        title: 'è‹±èªã§ã®ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³åŠ›å‘ä¸Š',
        category: 'learning',
        description: 'TOEIC900ç‚¹çªç ´ã¨ã€å›½éš›ä¼šè­°ã§ã®è‹±èªãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸã‚’ç›®æŒ‡ã—ã¾ã™ã€‚',
        targetPoints: 25,
        currentPoints: 19,
        supporters: ['user_sample3', 'user_sample4', 'user_sample8']
      },
      {
        id: 'fund10',
        creatorId: 'user_sample10',
        creatorName: 'åŠ è—¤ã‚†ã„',
        creatorIcon: 'ğŸ¦‰',
        title: 'å†™çœŸé›†åˆ¶ä½œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ',
        category: 'creation',
        description: 'æ—¥æœ¬å„åœ°ã®é¢¨æ™¯ã‚’æ’®å½±ã—ã€å››å­£ã®ç¾ã—ã•ã‚’ä¼ãˆã‚‹å†™çœŸé›†ã‚’åˆ¶ä½œã—ã¾ã™ã€‚',
        targetPoints: 35,
        currentPoints: 28,
        supporters: ['user_sample1', 'user_sample5', 'user_sample6', 'user_sample9']
      },
      {
        id: 'fund11',
        creatorId: 'user_sample11',
        creatorName: 'æ¾æœ¬ç¿”å¤ª',
        creatorIcon: 'ğŸ§',
        title: 'YouTubeã§æ•™è‚²ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é…ä¿¡',
        category: 'challenge',
        description: 'æ•°å­¦ã¨ç‰©ç†ã‚’åˆ†ã‹ã‚Šã‚„ã™ãè§£èª¬ã™ã‚‹æ•™è‚²YouTubeãƒãƒ£ãƒ³ãƒãƒ«ã‚’ç«‹ã¡ä¸Šã’ã€100æœ¬ã®å‹•ç”»æŠ•ç¨¿ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚',
        targetPoints: 30,
        currentPoints: 12,
        supporters: ['user_sample2', 'user_sample7']
      },
      {
        id: 'fund12',
        creatorId: 'user_sample12',
        creatorName: 'äº•ä¸Šæ„›',
        creatorIcon: 'ğŸ¦„',
        title: 'é«˜é½¢è€…å‘ã‘ã‚¹ãƒãƒ›æ•™å®¤ã®é–‹å‚¬',
        category: 'social',
        description: 'åœ°åŸŸã®é«˜é½¢è€…ã®æ–¹ã€…ã«ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã®ä½¿ã„æ–¹ã‚’ä¸å¯§ã«æ•™ãˆã‚‹æ•™å®¤ã‚’æ¯é€±é–‹å‚¬ã—ã¾ã™ã€‚',
        targetPoints: 18,
        currentPoints: 16,
        supporters: ['user_sample3', 'user_sample8', 'user_sample10']
      },
      {
        id: 'fund13',
        creatorId: 'user_sample13',
        creatorName: 'æœ¨æ‘é¾ä¹‹ä»‹',
        creatorIcon: 'ğŸŒŸ',
        title: '3Dãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã¨ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶ä½œ',
        category: 'creation',
        description: 'Blenderã‚’ä½¿ã£ãŸ3DCGåˆ¶ä½œæŠ€è¡“ã‚’ç¿’å¾—ã—ã€ã‚ªãƒªã‚¸ãƒŠãƒ«ã®çŸ­ç·¨ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åˆ¶ä½œã—ã¾ã™ã€‚',
        targetPoints: 28,
        currentPoints: 20,
        supporters: ['user_sample4', 'user_sample5', 'user_sample11']
      },
      {
        id: 'fund14',
        creatorId: 'user_sample14',
        creatorName: 'æ—ç¾ç©‚',
        creatorIcon: 'ğŸ’',
        title: 'AIãƒ»æ©Ÿæ¢°å­¦ç¿’ã®å®Ÿè·µãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ',
        category: 'learning',
        description: 'TensorFlowã‚’ä½¿ã£ãŸç”»åƒèªè­˜AIã‚’é–‹ç™ºã—ã€å®Ÿç”¨çš„ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚',
        targetPoints: 35,
        currentPoints: 27,
        supporters: ['user_sample1', 'user_sample6', 'user_sample9', 'user_sample12']
      },
      {
        id: 'fund15',
        creatorId: 'user_sample15',
        creatorName: 'æ£®ç”°å¥',
        creatorIcon: 'ğŸ¶',
        title: 'ãƒˆãƒ©ã‚¤ã‚¢ã‚¹ãƒ­ãƒ³å®Œèµ°ã¸ã®æŒ‘æˆ¦',
        category: 'challenge',
        description: 'æ°´æ³³ãƒ»è‡ªè»¢è»Šãƒ»ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ã®3ç¨®ç›®ã«æŒ‘æˆ¦ã—ã€1å¹´å¾Œã®ãƒˆãƒ©ã‚¤ã‚¢ã‚¹ãƒ­ãƒ³å¤§ä¼šå®Œèµ°ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚',
        targetPoints: 25,
        currentPoints: 10,
        supporters: ['user_sample7', 'user_sample13']
      }
    ];

    // Global State
    let currentUser = {
      id: 'user_me',
      displayName: '',
      icon: 'ğŸ‘¤',
      points: 10,
      supportedFunds: [],
      receivedSupports: 0,
      isPremium: false
    };
    let currentView = 'feed';
    let currentFilter = 'all';
    let isWatchingAd = false;
    let funds = [...SAMPLE_FUNDS];

    // Initialize user
    function initializeUser() {
      const savedUser = localStorage.getItem('onlyOneFundUser');
      if (savedUser) {
        try {
          currentUser = JSON.parse(savedUser);
        } catch (e) {
          // Use default user
        }
      }
      render();
    }

    // Save user
    function saveUser() {
      localStorage.setItem('onlyOneFundUser', JSON.stringify(currentUser));
    }

    // Get badge based on support count
    function getBadge(supportCount) {
      if (supportCount >= 10) return { name: 'Mentor', icon: 'ğŸŒŸ' };
      if (supportCount >= 5) return { name: 'Backer', icon: 'â­' };
      return { name: 'Supporter', icon: 'âœ¨' };
    }

    // Check if user can support fund
    function canSupport(fund) {
      return currentUser.points >= 1 
        && !currentUser.supportedFunds.includes(fund.id)
        && currentUser.id !== fund.creatorId;
    }

    // Check if user can create fund
    function canCreateFund() {
      return currentUser.supportedFunds.length >= 5;
    }

    // Get max target points based on premium status
    function getMaxTargetPoints() {
      return currentUser.isPremium ? 200 : 100;
    }

    // Get monthly fund creation limit
    function getMonthlyFundLimit() {
      return currentUser.isPremium ? 3 : 1;
    }

    // Support a fund
    function supportFund(fund) {
      if (!canSupport(fund)) return;

      currentUser.points -= 1;
      currentUser.supportedFunds.push(fund.id);
      
      const fundIndex = funds.findIndex(f => f.id === fund.id);
      if (fundIndex !== -1) {
        funds[fundIndex].currentPoints += 1;
        funds[fundIndex].supporters.push(currentUser.id);
      }

      saveUser();
      showToast('ğŸ‰ å¿œæ´ã‚’é€ã‚Šã¾ã—ãŸï¼', 'success');
      render();
    }

    // Watch ad to earn points
    function watchAd() {
      if (isWatchingAd) return;
      isWatchingAd = true;

      // Show ad modal
      const modal = document.createElement('div');
      modal.className = 'ad-modal-overlay';
      modal.innerHTML = `
        <div class="ad-modal">
          <div class="ad-icon">ğŸ“º</div>
          <div class="ad-title">åºƒå‘Šã‚’è¦–è´ä¸­...</div>
          <div class="ad-message">5ç§’é–“ãŠå¾…ã¡ãã ã•ã„</div>
          <div class="ad-timer" id="adTimer">5</div>
          <div class="ad-progress">
            <div class="ad-progress-fill" id="adProgress" style="width: 0%"></div>
          </div>
          <div id="adCompleteMessage" style="display: none;">
            <div class="ad-icon">ğŸ‰</div>
            <div class="ad-title">+1ãƒã‚¤ãƒ³ãƒˆç²å¾—ï¼</div>
            <button class="btn-close-ad" onclick="closeAdModal()">é–‰ã˜ã‚‹</button>
          </div>
        </div>
      `;
      document.body.appendChild(modal);

      // Start countdown
      let timeLeft = 5;
      const timerElement = document.getElementById('adTimer');
      const progressElement = document.getElementById('adProgress');

      const countdown = setInterval(() => {
        timeLeft--;
        if (timerElement) {
          timerElement.textContent = timeLeft;
        }
        if (progressElement) {
          progressElement.style.width = ((5 - timeLeft) / 5 * 100) + '%';
        }

        if (timeLeft <= 0) {
          clearInterval(countdown);
          
          // Show completion message
          const completeMessage = document.getElementById('adCompleteMessage');
          if (completeMessage) {
            document.querySelector('.ad-message').style.display = 'none';
            timerElement.style.display = 'none';
            progressElement.parentElement.style.display = 'none';
            completeMessage.style.display = 'block';
          }
        }
      }, 1000);
    }

    window.closeAdModal = function() {
      const modal = document.querySelector('.ad-modal-overlay');
      if (modal) {
        modal.remove();
      }
      isWatchingAd = false;
      
      currentUser.points += 1;
      saveUser();
      showToast('âœ¨ 1ãƒã‚¤ãƒ³ãƒˆç²å¾—ã—ã¾ã—ãŸï¼', 'success');
      render();
    };

    // Create user account
    function createUserAccount(displayName, icon) {
      currentUser.displayName = displayName;
      currentUser.icon = icon;
      saveUser();
      showToast('ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼', 'success');
      render();
    }

    // Create fund
    function createFund(fundData) {
      if (!canCreateFund()) return;

      const newFund = {
        id: 'fund_' + Date.now(),
        creatorId: currentUser.id,
        creatorName: currentUser.displayName,
        creatorIcon: currentUser.icon,
        title: fundData.title,
        category: fundData.category,
        description: fundData.description,
        targetPoints: fundData.targetPoints,
        currentPoints: 0,
        supporters: []
      };

      funds.unshift(newFund);
      showToast('ğŸ‰ ãƒ•ã‚¡ãƒ³ãƒ‰ã‚’ä½œæˆã—ã¾ã—ãŸï¼', 'success');
      currentView = 'feed';
      render();
    }

    // Show premium purchase modal
    function showPremiumModal() {
      const modal = document.createElement('div');
      modal.className = 'ad-modal-overlay';
      modal.innerHTML = `
        <div class="ad-modal">
          <div class="ad-icon">ğŸ’³</div>
          <div class="ad-title">ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ç™»éŒ²</div>
          <div class="ad-message">
            ã“ã®æ©Ÿèƒ½ã¯ãƒ‡ãƒ¢è¡¨ç¤ºã§ã™ã€‚<br>
            å®Ÿéš›ã®èª²é‡‘æ©Ÿèƒ½ã¯å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
          </div>
          <button class="btn-close-ad" onclick="closePremiumModal()">é–‰ã˜ã‚‹</button>
        </div>
      `;
      document.body.appendChild(modal);
    }

    window.closePremiumModal = function() {
      const modal = document.querySelector('.ad-modal-overlay');
      if (modal) {
        modal.remove();
      }
    };

    // Show toast notification
    function showToast(message, type = 'info') {
      const existingToast = document.querySelector('.toast');
      if (existingToast) {
        existingToast.remove();
      }

      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.textContent = message;
      document.body.appendChild(toast);

      setTimeout(() => {
        toast.remove();
      }, 3000);
    }

    // Render functions
    function render() {
      const app = document.getElementById('app');

      if (!currentUser.displayName) {
        app.innerHTML = renderWelcomeScreen();
        return;
      }

      app.innerHTML = `
        <div class="container">
          ${renderHeader()}
          ${renderNavigation()}
          ${renderContent()}
        </div>
      `;
    }

    function renderWelcomeScreen() {
      const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
      return `
        <div class="welcome-screen">
          <div class="welcome-icon">ğŸ¯</div>
          <h1 class="welcome-title">${config.welcome_title || defaultConfig.welcome_title}</h1>
          <p class="welcome-subtitle">æŒ‘æˆ¦ã¨å¿œæ´ã§ã¤ãªãæ–°ã—ã„SNS</p>
          
          <div class="welcome-concept">
            <h3>ğŸ’¡ ã“ã®ã‚¢ãƒ—ãƒªã®æ€æƒ³</h3>
            <p>${config.points_explanation || defaultConfig.points_explanation}ã€‚</p>
            <p>1ãƒã‚¤ãƒ³ãƒˆã¯ã€ŒãŠé‡‘ã€ã§ã¯ãªãã€<strong>ã€Œæ‰¿èªã€ã€Œå¿œæ´ã€</strong>ã®å½¢ã§ã™ã€‚</p>
            <p>èª°ã‹ã®æŒ‘æˆ¦ãƒ»å­¦ç¿’ãƒ»å‰µä½œã‚’å¿œæ´ã™ã‚‹ã“ã¨ã§ã€ã‚ãªãŸã®å½±éŸ¿åŠ›ãŒè¨˜éŒ²ã•ã‚Œã€é–¢ä¿‚æ€§ãŒå¯è¦–åŒ–ã•ã‚Œã¾ã™ã€‚</p>
            <p>åºƒå‘Šã‚’è¦‹ã‚‹ã“ã¨ã§ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ ç²å¾—ã§ãã¾ã™ã€‚</p>
          </div>

          <div class="welcome-rules">
            <h4>ğŸ“Œ åŸºæœ¬ãƒ«ãƒ¼ãƒ«</h4>
            <ul>
              <li>åˆæœŸãƒã‚¤ãƒ³ãƒˆ10ptï¼ˆåºƒå‘Šè¦–è´ã§å¢—ã‚„ã›ã‚‹ï¼‰</li>
              <li>1ãƒ•ã‚¡ãƒ³ãƒ‰ã«1å›ã®ã¿å¿œæ´å¯èƒ½</li>
              <li>ãƒ•ã‚¡ãƒ³ãƒ‰ä½œæˆã«ã¯5å›ä»¥ä¸Šå¿œæ´ãŒå¿…è¦</li>
              <li>æœˆ1å›ã¾ã§ãƒ•ã‚¡ãƒ³ãƒ‰ä½œæˆå¯èƒ½ï¼ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã§3å›ï¼‰</li>
              <li>ç‰©æ¬²ãƒ»å¨¯æ¥½ç›®çš„ã¯ç¦æ­¢</li>
            </ul>
          </div>

          <div style="max-width: 400px; margin: 0 auto;">
            <form id="accountForm" onsubmit="handleAccountCreate(event)">
              <div class="icon-selection">
                <label class="icon-selection-label">
                  ã‚ãªãŸã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’é¸ã‚“ã§ãã ã•ã„
                </label>
                <div class="icon-grid" id="iconGrid">
                  ${AVAILABLE_ICONS.map((icon, index) => `
                    <div class="icon-option ${index === 0 ? 'selected' : ''}" data-icon="${icon}" onclick="selectIcon('${icon}')">
                      ${icon}
                    </div>
                  `).join('')}
                </div>
                <input type="hidden" id="selectedIcon" name="icon" value="${AVAILABLE_ICONS[0]}" required>
              </div>

              <div style="margin-bottom: 16px;">
                <label style="display: block; font-size: 14px; margin-bottom: 8px; opacity: 0.95;">
                  è¡¨ç¤ºåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                </label>
                <input 
                  type="text" 
                  id="displayName" 
                  name="displayName" 
                  class="welcome-input"
                  placeholder="ä¾‹ï¼šç”°ä¸­å¤ªéƒ"
                  required
                  maxlength="20"
                >
              </div>
              <button type="submit" class="btn-start">
                å§‹ã‚ã‚‹
              </button>
            </form>
          </div>
        </div>
      `;
    }

    function renderHeader() {
      const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
      const badge = getBadge(currentUser.supportedFunds.length);
      return `
        <div class="header">
          <div>
            <div class="header-title">${config.app_title || defaultConfig.app_title}</div>
          </div>
          <div class="header-points">
            ${badge.icon} æ®‹ã‚Š<span class="points-number">${currentUser.points}</span>pt
          </div>
        </div>
      `;
    }

    function renderNavigation() {
      return `
        <div class="nav-tabs">
          <button class="nav-tab ${currentView === 'feed' ? 'active' : ''}" onclick="changeView('feed')">
            ğŸ  ãƒ›ãƒ¼ãƒ 
          </button>
          <button class="nav-tab ${currentView === 'profile' ? 'active' : ''}" onclick="changeView('profile')">
            ğŸ‘¤ ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«
          </button>
          <button class="nav-tab ${currentView === 'create' ? 'active' : ''}" onclick="changeView('create')">
            â• ä½œæˆ
          </button>
        </div>
      `;
    }

    function renderContent() {
      switch (currentView) {
        case 'feed':
          return renderFeed();
        case 'profile':
          return renderProfile();
        case 'create':
          return renderCreateFund();
        default:
          return renderFeed();
      }
    }

    function renderFeed() {
      const filteredFunds = currentFilter === 'all' 
        ? funds 
        : funds.filter(f => f.category === currentFilter);

      return `
        <div class="feed">
          ${renderEarnPointsCard()}
          
          <div class="category-filter">
            <button class="filter-btn ${currentFilter === 'all' ? 'active' : ''}" onclick="setFilter('all')">
              ã™ã¹ã¦
            </button>
            <button class="filter-btn ${currentFilter === 'challenge' ? 'active' : ''}" onclick="setFilter('challenge')">
              ğŸ¯ æŒ‘æˆ¦
            </button>
            <button class="filter-btn ${currentFilter === 'creation' ? 'active' : ''}" onclick="setFilter('creation')">
              ğŸ¨ å‰µä½œ
            </button>
            <button class="filter-btn ${currentFilter === 'learning' ? 'active' : ''}" onclick="setFilter('learning')">
              ğŸ“š å­¦ç¿’
            </button>
            <button class="filter-btn ${currentFilter === 'social' ? 'active' : ''}" onclick="setFilter('social')">
              ğŸŒ ç¤¾ä¼š
            </button>
          </div>

          ${filteredFunds.map(fund => renderFundCard(fund)).join('')}
        </div>
      `;
    }

    function renderEarnPointsCard() {
      return `
        <div class="earn-points-card">
          <div class="earn-points-title">
            ğŸ’° ãƒã‚¤ãƒ³ãƒˆã‚’ç²å¾—ã—ã‚ˆã†
          </div>
          <div class="earn-points-description">
            åºƒå‘Šã‚’è¦–è´ã—ã¦1ãƒã‚¤ãƒ³ãƒˆç²å¾—ã§ãã¾ã™ã€‚<br>
            ç²å¾—ã—ãŸãƒã‚¤ãƒ³ãƒˆã§ã•ã‚‰ã«å¤šãã®æŒ‘æˆ¦ã‚’å¿œæ´ã—ã¾ã—ã‚‡ã†ï¼
          </div>
          <button 
            class="btn-watch-ad" 
            onclick="handleWatchAd()"
            ${isWatchingAd ? 'disabled' : ''}
          >
            ğŸ“º åºƒå‘Šã‚’è¦‹ã¦+1ptç²å¾—
          </button>
        </div>
      `;
    }

    function renderFundCard(fund) {
      const progress = (fund.currentPoints / fund.targetPoints) * 100;
      const canSupportThis = canSupport(fund);
      const isOwn = currentUser.id === fund.creatorId;

      const categoryIcons = {
        challenge: 'ğŸ¯',
        creation: 'ğŸ¨',
        learning: 'ğŸ“š',
        social: 'ğŸŒ'
      };

      const categoryLabels = {
        challenge: 'æŒ‘æˆ¦',
        creation: 'å‰µä½œ',
        learning: 'å­¦ç¿’',
        social: 'ç¤¾ä¼š'
      };

      return `
        <div class="fund-card">
          <div class="fund-header">
            <div style="flex: 1;">
              <h3 class="fund-title">${fund.title}</h3>
              <div class="fund-creator">
                <span class="fund-creator-icon">${fund.creatorIcon}</span>
                <span>by ${fund.creatorName}</span>
              </div>
            </div>
            <span class="category-badge category-${fund.category}">
              ${categoryIcons[fund.category]} ${categoryLabels[fund.category]}
            </span>
          </div>

          <p class="fund-description">${fund.description}</p>

          <div class="progress-section">
            <div class="progress-label">
              <span>é€²æ—</span>
              <span><strong>${fund.currentPoints}</strong> / ${fund.targetPoints}pt</span>
            </div>
            <div class="progress-bar-bg">
              <div class="progress-bar-fill" style="width: ${Math.min(progress, 100)}%"></div>
            </div>
          </div>

          ${fund.supporters.length > 0 ? `
            <div class="supporters-section">
              ${fund.supporters.slice(0, 5).map(() => {
                return `<div class="supporter-avatar">ğŸ‘¤</div>`;
              }).join('')}
              ${fund.supporters.length > 5 ? `<span class="supporter-count">+${fund.supporters.length - 5}</span>` : ''}
              <span class="supporter-count">${fund.supporters.length}äººãŒå¿œæ´</span>
            </div>
          ` : ''}

          <div class="fund-actions">
            ${!isOwn ? `
              <button 
                class="btn-support" 
                onclick="handleSupportClick('${fund.id}')"
                ${!canSupportThis ? 'disabled' : ''}
              >
                ${canSupportThis ? 'â¤ï¸ 1ptå¿œæ´ã™ã‚‹' : 
                  currentUser.points < 1 ? 'ğŸ’” ãƒã‚¤ãƒ³ãƒˆä¸è¶³' : 
                  'âœ… å¿œæ´æ¸ˆã¿'}
              </button>
            ` : `
              <button class="btn-support" disabled>
                ğŸ‘¤ è‡ªåˆ†ã®ãƒ•ã‚¡ãƒ³ãƒ‰
              </button>
            `}
          </div>
        </div>
      `;
    }

    function renderProfile() {
      const supportedFunds = funds.filter(f => currentUser.supportedFunds.includes(f.id));
      const myFunds = funds.filter(f => f.creatorId === currentUser.id);
      const badge = getBadge(currentUser.supportedFunds.length);
      const canCreate = canCreateFund();

      return `
        <div class="profile">
          <div class="profile-header">
            <div class="profile-avatar">${currentUser.icon}</div>
            <div class="profile-name">${currentUser.displayName}</div>
            <div class="profile-badge">${badge.icon} ${badge.name} ${currentUser.isPremium ? 'ğŸ‘‘' : ''}</div>
            
            <div class="profile-stats">
              <div class="stat-item">
                <span class="stat-value">${currentUser.points}</span>
                <span class="stat-label">æ®‹ã‚Šãƒã‚¤ãƒ³ãƒˆ</span>
              </div>
              <div class="stat-item">
                <span class="stat-value">${currentUser.supportedFunds.length}</span>
                <span class="stat-label">å¿œæ´ã—ãŸæ•°</span>
              </div>
              <div class="stat-item">
                <span class="stat-value">${currentUser.receivedSupports}</span>
                <span class="stat-label">å—ã‘ãŸå¿œæ´</span>
              </div>
            </div>
          </div>

          ${!currentUser.isPremium ? renderPremiumCard() : ''}

          ${renderEarnPointsCard()}

          ${!canCreate ? `
            <div class="create-fund-requirement">
              <strong>âš ï¸ ãƒ•ã‚¡ãƒ³ãƒ‰ä½œæˆã®æ¡ä»¶</strong><br>
              5å›ä»¥ä¸Šä»–ã®äººã®ãƒ•ã‚¡ãƒ³ãƒ‰ã‚’å¿œæ´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆç¾åœ¨${currentUser.supportedFunds.length}å›å¿œæ´ï¼‰
            </div>
          ` : ''}

          <button 
            class="btn-create-fund" 
            onclick="changeView('create')"
            ${!canCreate ? 'disabled' : ''}
          >
            â• æ–°ã—ã„ãƒ•ã‚¡ãƒ³ãƒ‰ã‚’ä½œã‚‹
          </button>

          <h2 class="section-title">â¤ï¸ å¿œæ´ã—ãŸæŒ‘æˆ¦</h2>
          ${supportedFunds.length === 0 ? `
            <div class="empty-state">
              <div class="empty-icon">ğŸ’­</div>
              <p class="empty-text">ã¾ã å¿œæ´ã—ã¦ã„ã¾ã›ã‚“</p>
            </div>
          ` : supportedFunds.map(fund => renderFundCard(fund)).join('')}

          <h2 class="section-title" style="margin-top: 32px;">ğŸ¯ è‡ªåˆ†ã®ãƒ•ã‚¡ãƒ³ãƒ‰</h2>
          ${myFunds.length === 0 ? `
            <div class="empty-state">
              <div class="empty-icon">ğŸ“</div>
              <p class="empty-text">ã¾ã ãƒ•ã‚¡ãƒ³ãƒ‰ã‚’ä½œæˆã—ã¦ã„ã¾ã›ã‚“</p>
            </div>
          ` : myFunds.map(fund => renderFundCard(fund)).join('')}
        </div>
      `;
    }

    function renderPremiumCard() {
      return `
        <div class="premium-card">
          <div class="premium-title">
            ğŸ‘‘ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡
            <span class="demo-badge">ãƒ‡ãƒ¢è¡¨ç¤º</span>
          </div>
          <div class="premium-benefits">
            <div class="premium-benefit-item">
              æœˆ3å›ã¾ã§ãƒ•ã‚¡ãƒ³ãƒ‰ä½œæˆå¯èƒ½ï¼ˆé€šå¸¸ã¯æœˆ1å›ï¼‰
            </div>
            <div class="premium-benefit-item">
              ç›®æ¨™ãƒã‚¤ãƒ³ãƒˆä¸Šé™200ptï¼ˆé€šå¸¸ã¯100ptï¼‰
            </div>
            <div class="premium-benefit-item">
              ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒãƒƒã‚¸è¡¨ç¤º
            </div>
            <div class="premium-benefit-item">
              å„ªå…ˆçš„ãªã‚µãƒãƒ¼ãƒˆå¯¾å¿œ
            </div>
          </div>
          <div class="premium-price">
            <div class="price-amount">Â¥980</div>
            <div class="price-period">/æœˆé¡</div>
          </div>
          <button class="btn-premium" onclick="showPremiumModal()">
            ğŸ’³ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ã«ãªã‚‹
          </button>
        </div>
      `;
    }

    function renderCreateFund() {
      const canCreate = canCreateFund();
      const maxPoints = getMaxTargetPoints();
      const monthlyLimit = getMonthlyFundLimit();

      if (!canCreate) {
        return `
          <div class="create-fund-form">
            <div class="create-fund-requirement">
              <strong>âš ï¸ ãƒ•ã‚¡ãƒ³ãƒ‰ã‚’ä½œæˆã§ãã¾ã›ã‚“</strong><br><br>
              5å›ä»¥ä¸Šä»–ã®äººã®ãƒ•ã‚¡ãƒ³ãƒ‰ã‚’å¿œæ´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚<br>
              ç¾åœ¨${currentUser.supportedFunds.length}å›å¿œæ´ã—ã¦ã„ã¾ã™ã€‚
            </div>
            <button class="btn-submit" onclick="changeView('profile')">
              ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã«æˆ»ã‚‹
            </button>
          </div>
        `;
      }

      return `
        <div class="create-fund-form">
          <h2 class="section-title">âœ¨ æ–°ã—ã„ãƒ•ã‚¡ãƒ³ãƒ‰ã‚’ä½œã‚‹</h2>

          ${currentUser.isPremium ? `
            <div style="background: #d4edda; border-left: 4px solid #28a745; padding: 12px; border-radius: 8px; font-size: 13px; color: #155724; margin-bottom: 24px;">
              ğŸ‘‘ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ç‰¹å…¸: æœˆ${monthlyLimit}å›ã¾ã§ä½œæˆå¯èƒ½ã€ç›®æ¨™ãƒã‚¤ãƒ³ãƒˆæœ€å¤§${maxPoints}pt
            </div>
          ` : ''}

          <div class="warning-box">
            <div class="warning-title">âš ï¸ ç¦æ­¢äº‹é …</div>
            <div class="warning-text">
              ç‰©æ¬²ãƒ»å¨¯æ¥½ç›®çš„ï¼ˆã‚²ãƒ¼ãƒ è³¼å…¥ã€æ—…è¡Œãªã©ï¼‰ã®ãƒ•ã‚¡ãƒ³ãƒ‰ã¯ç¦æ­¢ã§ã™ã€‚<br>
              æ•™è‚²çš„ä¾¡å€¤ã®ã‚ã‚‹æŒ‘æˆ¦ãƒ»å‰µä½œãƒ»å­¦ç¿’ã‚’ç›®çš„ã¨ã—ã¦ãã ã•ã„ã€‚
            </div>
          </div>

          <form id="createFundForm" onsubmit="handleCreateFund(event)">
            <div class="form-group">
              <label class="form-label">ã‚«ãƒ†ã‚´ãƒª *</label>
              <div class="category-select" id="categorySelect">
                <div class="category-option" data-category="challenge">
                  <div class="category-option-icon">ğŸ¯</div>
                  <div class="category-option-label">æŒ‘æˆ¦</div>
                </div>
                <div class="category-option" data-category="creation">
                  <div class="category-option-icon">ğŸ¨</div>
                  <div class="category-option-label">å‰µä½œ</div>
                </div>
                <div class="category-option" data-category="learning">
                  <div class="category-option-icon">ğŸ“š</div>
                  <div class="category-option-label">å­¦ç¿’</div>
                </div>
                <div class="category-option" data-category="social">
                  <div class="category-option-icon">ğŸŒ</div>
                  <div class="category-option-label">ç¤¾ä¼š</div>
                </div>
              </div>
              <input type="hidden" id="categoryInput" name="category" required>
            </div>

            <div class="form-group">
              <label class="form-label" for="title">ã‚¿ã‚¤ãƒˆãƒ« *</label>
              <input 
                type="text" 
                id="title" 
                name="title" 
                class="form-input" 
                placeholder="ä¾‹ï¼šãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚¹ã‚­ãƒ«ã‚’ç¿’å¾—ã™ã‚‹" 
                required
                maxlength="50"
              >
            </div>

            <div class="form-group">
              <label class="form-label" for="description">ç›®çš„èª¬æ˜ *</label>
              <textarea 
                id="description" 
                name="description" 
                class="form-input form-textarea" 
                placeholder="ã“ã®æŒ‘æˆ¦ã®ç›®çš„ã‚„æ„ç¾©ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ï¼ˆ200æ–‡å­—ä»¥å†…ï¼‰" 
                required
                maxlength="200"
                oninput="updateCharCount()"
              ></textarea>
              <div class="char-count" id="charCount">0 / 200</div>
            </div>

            <div class="form-group">
              <label class="form-label" for="targetPoints">ç›®æ¨™ãƒã‚¤ãƒ³ãƒˆ *</label>
              <input 
                type="number" 
                id="targetPoints" 
                name="targetPoints" 
                class="form-input" 
                placeholder="ä¾‹ï¼š20" 
                required
                min="5"
                max="${maxPoints}"
              >
              <div class="char-count">5ã€œ${maxPoints}ptã®ç¯„å›²ã§è¨­å®šã—ã¦ãã ã•ã„</div>
            </div>

            <button type="submit" class="btn-submit">
              ğŸš€ ãƒ•ã‚¡ãƒ³ãƒ‰ã‚’ä½œæˆã™ã‚‹
            </button>
          </form>
        </div>
      `;
    }

    // Event handlers
    window.selectIcon = function(icon) {
      const iconOptions = document.querySelectorAll('.icon-option');
      iconOptions.forEach(opt => opt.classList.remove('selected'));
      
      const selectedOption = document.querySelector(`[data-icon="${icon}"]`);
      if (selectedOption) {
        selectedOption.classList.add('selected');
      }
      
      document.getElementById('selectedIcon').value = icon;
    };

    window.handleAccountCreate = function(event) {
      event.preventDefault();
      const displayName = document.getElementById('displayName').value.trim();
      const icon = document.getElementById('selectedIcon').value;
      
      if (displayName && icon) {
        createUserAccount(displayName, icon);
      }
    };

    window.changeView = function(view) {
      currentView = view;
      render();

      // Setup category selection after render
      if (view === 'create') {
        setTimeout(() => {
          const categoryOptions = document.querySelectorAll('.category-option');
          categoryOptions.forEach(option => {
            option.addEventListener('click', function() {
              categoryOptions.forEach(opt => opt.classList.remove('selected'));
              this.classList.add('selected');
              document.getElementById('categoryInput').value = this.dataset.category;
            });
          });
        }, 0);
      }
    };

    window.setFilter = function(filter) {
      currentFilter = filter;
      render();
    };

    window.handleSupportClick = function(fundId) {
      const fund = funds.find(f => f.id === fundId);
      if (fund) {
        supportFund(fund);
      }
    };

    window.handleWatchAd = function() {
      watchAd();
    };

    window.updateCharCount = function() {
      const textarea = document.getElementById('description');
      const charCount = document.getElementById('charCount');
      if (textarea && charCount) {
        charCount.textContent = `${textarea.value.length} / 200`;
      }
    };

    window.handleCreateFund = function(event) {
      event.preventDefault();
      
      const form = event.target;
      const formData = new FormData(form);
      
      const fundData = {
        title: formData.get('title'),
        category: formData.get('category'),
        description: formData.get('description'),
        targetPoints: parseInt(formData.get('targetPoints'))
      };

      if (!fundData.category) {
        showToast('ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã—ã¦ãã ã•ã„', 'error');
        return;
      }

      const maxPoints = getMaxTargetPoints();
      if (fundData.targetPoints < 5 || fundData.targetPoints > maxPoints) {
        showToast(`ç›®æ¨™ãƒã‚¤ãƒ³ãƒˆã¯5ã€œ${maxPoints}ã®ç¯„å›²ã§è¨­å®šã—ã¦ãã ã•ã„`, 'error');
        return;
      }

      createFund(fundData);
    };

    // Initialize app
    initializeUser();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9b9034b6502f354b',t:'MTc2NzU4NzA2NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
